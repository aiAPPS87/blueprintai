# Blueprint AI

An AI-powered floor plan generator built with Next.js 14, Claude AI, and Konva.js.

## Features

- **Natural Language Input** — Describe your house in plain English
- **AI Floor Plan Generation** — Claude AI generates constraint-based floor plans
- **Interactive Canvas Editor** — Drag rooms, see real-time dimensions
- **AI Refinement Chat** — Conversational refinement ("make the kitchen bigger")
- **DXF Export** — Professional AutoCAD-compatible files
- **JPG Export** — High-resolution images (A3 equivalent)
- **Plan Saving** — Save and reload plans via Supabase
- **Stripe Payments** — Free tier + paid downloads + Pro subscription

## Tech Stack

- **Frontend:** Next.js 14 (App Router), TypeScript, Tailwind CSS
- **Canvas:** Konva.js / react-konva
- **AI:** Anthropic Claude API (claude-sonnet-4-6)
- **Database:** Supabase (Postgres + Auth)
- **Payments:** Stripe
- **CAD:** Custom DXF generator (DXF R12 format)

## Getting Started

### 1. Clone and install

```bash
git clone https://github.com/aiAPPS87/blueprintai.git
cd blueprintai
npm install
```

### 2. Set up environment variables

Copy `.env.example` to `.env.local` and fill in your keys:

```bash
cp .env.example .env.local
```

Required environment variables:

```env
# Anthropic Claude API
ANTHROPIC_API_KEY=your_anthropic_api_key

# Supabase
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

# Stripe
STRIPE_SECRET_KEY=your_stripe_secret_key
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret

# App URL
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### 3. Set up Supabase database

Run the SQL schema found in `lib/supabase.ts` (in the comments at the bottom) in your Supabase SQL editor.

### 4. Set up Stripe

1. Create two products in Stripe:
   - **Download Pack** — one-time $9 payment
   - **Pro Monthly** — recurring $29/month subscription
2. Copy the price IDs into `lib/stripe.ts`
3. Set up a Stripe webhook pointing to `/api/webhook`

### 5. Run the development server

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) in your browser.

## Project Structure

```
blueprintai/
├── app/
│   ├── page.tsx                    # Landing page
│   ├── app/page.tsx                # Main editor page
│   ├── dashboard/page.tsx          # Saved plans dashboard
│   └── api/
│       ├── generate/route.ts       # AI floor plan generation
│       ├── refine/route.ts         # AI plan refinement
│       ├── export/dxf/route.ts     # DXF file export
│       ├── export/jpg/route.ts     # JPG export preparation
│       ├── plans/route.ts          # Plan CRUD (Supabase)
│       ├── checkout/route.ts       # Stripe checkout
│       └── webhook/route.ts        # Stripe webhook handler
├── components/
│   ├── CanvasEditor.tsx            # Konva.js floor plan canvas
│   ├── ChatPanel.tsx               # AI chat interface
│   ├── ExportButtons.tsx           # DXF/JPG export buttons
│   └── PlanCard.tsx                # Dashboard plan card
├── lib/
│   ├── claude.ts                   # Claude API integration
│   ├── floorPlanEngine.ts          # Constraint-based layout engine
│   ├── dxfGenerator.ts             # DXF file builder
│   ├── jpgRenderer.ts              # Canvas-to-JPG renderer
│   ├── supabase.ts                 # Supabase client
│   └── stripe.ts                   # Stripe client
└── types/
    └── plan.ts                     # TypeScript type definitions
```

## Room Types & Minimum Sizes

| Room | Min Width | Min Height |
|------|-----------|------------|
| Bedroom | 3.0m | 3.0m |
| Master Bedroom | 4.0m | 3.5m |
| Bathroom | 1.8m | 2.4m |
| Ensuite | 1.5m | 2.0m |
| Kitchen | 3.0m | 3.5m |
| Living Room | 4.0m | 4.0m |
| Dining | 3.0m | 3.5m |
| Garage (single) | 3.0m | 5.5m |
| Garage (double) | 5.5m | 5.5m |
| Laundry | 1.8m | 2.0m |
| Hallway | 1.2m wide min | — |

## API Reference

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/generate` | POST | Generate floor plan from text |
| `/api/refine` | POST | Refine existing plan |
| `/api/export/dxf` | POST | Export as DXF file |
| `/api/export/jpg` | POST | JPG export metadata |
| `/api/plans` | GET/POST/DELETE | CRUD for saved plans |
| `/api/checkout` | POST | Create Stripe checkout session |
| `/api/webhook` | POST | Stripe webhook handler |

## Pricing

- **Free** — 3 plans, watermarked JPG
- **Download Pack** — $9 per DXF+JPG bundle
- **Pro** — $29/month unlimited

## Disclaimer

Plans generated by Blueprint AI are for conceptual purposes only. They are **not** suitable for construction, planning permits, or engineering purposes. Always consult a licensed architect or building designer for construction plans.

## License

MIT
